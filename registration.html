<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>GNMFA Youth Football</title>

  <!-- Shared theme -->
  <link rel="stylesheet" href="/Buffalos/assets/style.css" />

  <style>
    /* Hero image */
    .hero-bg-section{
      min-height: calc(100vh - 92px); /* header height */
      background:
        linear-gradient(180deg, rgba(0,0,0,.55), rgba(0,0,0,.75)),
        url("/Buffalos/assets/img/BuffHome2.png") top center / contain no-repeat;
      background-color: #060a13;
    }

    main{ display:block; }

    /* Sponsors block (under hero, above footer strip) */
    .sponsors-wrap{
      padding: 14px 0 18px;
      background: transparent;
    }
    .sponsors-card{
      width: min(1100px, 92vw);
      margin: 0 auto;
      border-radius: 18px;
      border: 1px solid rgba(255,255,255,.10);
      background: rgba(255,255,255,.06);
      box-shadow: 0 10px 26px rgba(0,0,0,.22);
      padding: 14px;
    }
    .sponsors-title{
      margin:0 0 12px;
      font-weight: 1000;
      letter-spacing: 1px;
      text-transform: uppercase;
      font-size: 14px;
      color: rgba(255,255,255,.92);
      text-align:center;
    }
    .sponsors-grid{
      display:grid;
      gap:12px;
      grid-template-columns: 1fr 1fr 1fr;
      align-items:center;
    }
    .sponsor-tile{
      border-radius: 16px;
      border: 1px solid rgba(255,255,255,.10);
      background: rgba(0,0,0,.18);
      overflow:hidden;
      aspect-ratio: 1 / 1;
      display:grid;
      place-items:center;
      padding:10px;
    }
    .sponsor-tile img{
      width: 100%;
      height: 100%;
      object-fit: contain;
      display:block;
      filter: drop-shadow(0 10px 18px rgba(0,0,0,.35));
    }
    .sponsors-thanks{
      margin: 12px 0 0;
      text-align:center;
      color: rgba(255,255,255,.78);
      font-size: 12px;
      line-height: 1.35;
      font-weight: 800;
      letter-spacing: .4px;
      text-transform: uppercase;
    }

    @media (max-width: 720px){
      .sponsors-grid{
        grid-template-columns: 1fr;
      }
      .sponsor-tile{
        aspect-ratio: 3 / 1;
      }
    }
  </style>
</head>

<body>

  <!-- Shared Header -->
  <header class="topbar camo">
    <div class="container">
      <div class="topbar-inner">
        <a class="brand" href="/Buffalos/index.html" aria-label="GNMFA Home">
          <img src="/Buffalos/assets/img/logo.png" alt="GNMFA logo" />
          <div class="text">
            <div class="title">GNMFA</div>
            <div class="subtitle">Youth Football</div>
          </div>
        </a>

        <nav class="nav" aria-label="Primary navigation">
          <a class="active" href="/Buffalos/index.html">Home</a>
          <a href="/Buffalos/current-season.html">Current Season</a>
          <a href="/Buffalos/registration.html">Registration</a>
          <a href="/Buffalos/more.html">More</a>
        </nav>

        <div class="actions">
          <a class="btn primary" href="/Buffalos/registration.html">Register</a>

          <button class="icon-btn mobile-toggle"
                  aria-label="Open menu"
                  aria-expanded="false"
                  data-mobile-toggle>
            <div class="burger-lines">
              <span></span><span></span><span></span>
            </div>
          </button>
        </div>
      </div>

      <!-- Mobile Menu -->
      <div class="mobile-menu" data-mobile-menu>
        <a class="active" href="/Buffalos/index.html">Home</a>
        <a href="/Buffalos/current-season.html">Current Season</a>
        <a href="/Buffalos/registration.html">Registration</a>
        <a href="/Buffalos/more.html">More</a>
      </div>
    </div>
  </header>

  <!-- HERO IMAGE -->
  <main>
    <section class="hero-bg-section" aria-label="GNMFA hero image"></section>

    <!-- Sponsors block (directly under hero) -->
    <section class="sponsors-wrap" aria-label="Sponsors">
      <div class="sponsors-card">
        <div class="sponsors-title">Thank you to our sponsors</div>

        <div class="sponsors-grid" role="list">
          <div class="sponsor-tile" role="listitem">
            <img id="sponsor1" alt="Sponsor logo 1" />
          </div>
          <div class="sponsor-tile" role="listitem">
            <img id="sponsor2" alt="Sponsor logo 2" />
          </div>
          <div class="sponsor-tile" role="listitem">
            <img id="sponsor3" alt="Sponsor logo 3" />
          </div>
        </div>

        <div class="sponsors-thanks">We appreciate your support</div>
      </div>
    </section>

    <!-- White footer strip (sits right under sponsors) -->
    <div class="site-banner">
      GREENWOOD NEWPORT MIDGET FOOTBALL ASSOCIATION
    </div>
  </main>

  <script src="/Buffalos/assets/site.js"></script>

  <script>
    // =========================
    // Sponsor Image Selection (Safe + Fallback)
    // Rules:
    // - 2 images from sponsormain01..20 (no duplicates)
    // - 1 image from sponsor01..20 (no duplicates)
    // - If only 1 sponsormain exists, fill with sponsor images
    // - If any file doesn't exist, fall back to sponsormain01.png and sponsor01.png
    // =========================

    const BASE = "/Buffalos/assets/img/";
    const FALLBACK_MAIN = `${BASE}sponsormain01.png`;
    const FALLBACK = `${BASE}sponsor01.png`;

    function buildList(prefix, max){
      return Array.from({length:max}, (_,i) =>
        `${BASE}${prefix}${String(i+1).padStart(2,'0')}.png`
      );
    }

    function imageExists(src){
      return new Promise(resolve => {
        const img = new Image();
        img.onload = () => resolve(true);
        img.onerror = () => resolve(false);
        img.src = src;
      });
    }

    async function pickValid(source, used, fallback){
      const shuffled = source
        .filter(s => !used.has(s))
        .sort(() => 0.5 - Math.random());

      for(const src of shuffled){
        if(await imageExists(src)){
          used.add(src);
          return src;
        }
      }
      // If none exist, use fallback
      return fallback;
    }

    async function countExisting(list){
      let count = 0;
      for(const src of list){
        if(await imageExists(src)) count++;
      }
      return count;
    }

    async function loadSponsors(){
      const mainList = buildList("sponsormain", 20);
      const regList  = buildList("sponsor", 20);
      const used = new Set();
      const picks = [];

      // How many sponsormain files actually exist?
      const mainCount = await countExisting(mainList);

      if(mainCount >= 2){
        // Pick 2 from sponsormain
        picks.push(await pickValid(mainList, used, FALLBACK_MAIN));
        picks.push(await pickValid(mainList, used, FALLBACK_MAIN));
        // Pick 1 from sponsor
        picks.push(await pickValid(regList, used, FALLBACK));
      } else if(mainCount === 1){
        // Pick 1 sponsormain, then 2 regular sponsors (no dupes)
        picks.push(await pickValid(mainList, used, FALLBACK_MAIN));
        picks.push(await pickValid(regList, used, FALLBACK));
        picks.push(await pickValid(regList, used, FALLBACK));
      } else {
        // No sponsormain exists: use fallback main + 2 regular sponsors
        picks.push(FALLBACK_MAIN);
        used.add(FALLBACK_MAIN);
        picks.push(await pickValid(regList, used, FALLBACK));
        picks.push(await pickValid(regList, used, FALLBACK));
      }

      const ids = ["sponsor1","sponsor2","sponsor3"];
      ids.forEach((id, i) => {
        const el = document.getElementById(id);
        if(!el) return;
        el.src = picks[i] || (i < 2 ? FALLBACK_MAIN : FALLBACK);

        // Final guard: if it STILL fails, hard fallback by slot type
        el.onerror = () => {
          el.onerror = null;
          el.src = (i < 2) ? FALLBACK_MAIN : FALLBACK;
        };
      });
    }

    loadSponsors();
  </script>
</body>
</html>

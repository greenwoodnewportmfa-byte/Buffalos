<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>GNMFA Youth Football</title>

  <!-- Shared theme -->
  <link rel="stylesheet" href="/Buffalos/assets/style.css" />

  <style>
    /* Index-only hero override */
    .hero-bg-section{
      min-height: calc(100vh - 92px);
      background:
        linear-gradient(180deg, rgba(0,0,0,.55), rgba(0,0,0,.75)),
        url("/Buffalos/assets/img/BuffHome2.png") top center / contain no-repeat;
      background-color: #060a13;
    }

    main{ display:block; }

    /* =========================
       Sponsors Block
       - Remove the big gap on mobile
       ========================= */
    .sponsors{
      padding: 10px 0 16px; /* tighter overall */
      margin-top: -18px;    /* pulls sponsors up closer to hero on mobile */
      background: rgba(0,0,0,.35);
      border-top: 1px solid rgba(255,255,255,.08);
      border-bottom: 1px solid rgba(255,255,255,.08);
    }
    @media (min-width: 720px){
      .sponsors{
        padding: 22px 0 18px;
        margin-top: 0; /* donâ€™t pull up on desktop */
      }
    }

    .sponsors-inner{
      width: min(1100px, 92vw);
      margin: 0 auto;
      text-align: center;
    }

    .sponsors h2{
      margin: 0 0 12px;
      font-size: 16px;
      font-weight: 1000;
      letter-spacing: 1px;
      text-transform: uppercase;
    }

    .sponsor-grid{
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 12px;
      align-items: center;
      justify-items: center;
      margin-bottom: 12px;
    }

    .sponsor-tile{
      width: 100%;
      aspect-ratio: 1 / 1;
      max-width: 160px;
      border-radius: 16px;
      background: rgba(255,255,255,.08);
      border: 1px solid rgba(255,255,255,.12);
      display: grid;
      place-items: center;
      padding: 12px;
    }

    .sponsor-tile img{
      max-width: 100%;
      max-height: 100%;
      object-fit: contain;
      display: block;
      filter: drop-shadow(0 10px 18px rgba(0,0,0,.35));
    }

    .sponsors .thanks{
      font-size: 12px;
      color: rgba(255,255,255,.78);
      letter-spacing: .4px;
      text-transform: uppercase;
      font-weight: 900;
    }

    @media (max-width: 520px){
      .sponsor-tile{ max-width: 110px; padding: 10px; }
      .sponsors h2{ font-size: 14px; margin-bottom: 10px; }
    }
  </style>
</head>

<body>

  <!-- Shared Header -->
  <header class="topbar camo">
    <div class="container">
      <div class="topbar-inner">
        <a class="brand" href="/Buffalos/index.html" aria-label="GNMFA Home">
          <img src="/Buffalos/assets/img/logo.png" alt="GNMFA logo" />
          <div class="text">
            <div class="title">GNMFA</div>
            <div class="subtitle">Youth Football</div>
          </div>
        </a>

        <nav class="nav" aria-label="Primary navigation">
          <a class="active" href="/Buffalos/index.html">Home</a>
          <a href="/Buffalos/current-season.html">Current Season</a>
          <a href="/Buffalos/registration.html">Registration</a>
          <a href="/Buffalos/more.html">More</a>
        </nav>

        <div class="actions">
          <a class="btn primary" href="/Buffalos/registration.html">Register</a>
          <button class="icon-btn mobile-toggle" data-mobile-toggle>
            <div class="burger-lines"><span></span><span></span><span></span></div>
          </button>
        </div>
      </div>

      <div class="mobile-menu" data-mobile-menu>
        <a class="active" href="/Buffalos/index.html">Home</a>
        <a href="/Buffalos/current-season.html">Current Season</a>
        <a href="/Buffalos/registration.html">Registration</a>
        <a href="/Buffalos/more.html">More</a>
      </div>
    </div>
  </header>

  <!-- HERO -->
  <main>
    <section class="hero-bg-section" aria-label="GNMFA hero image"></section>

    <!-- SPONSORS -->
    <section class="sponsors" aria-label="Sponsors">
      <div class="sponsors-inner">
        <h2>Thank You to Our Sponsors</h2>

        <div class="sponsor-grid" role="list">
          <div class="sponsor-tile" role="listitem"><img id="sponsor1" alt="Sponsor logo 1"></div>
          <div class="sponsor-tile" role="listitem"><img id="sponsor2" alt="Sponsor logo 2"></div>
          <div class="sponsor-tile" role="listitem"><img id="sponsor3" alt="Sponsor logo 3"></div>
        </div>

        <div class="thanks">We appreciate your support</div>
      </div>
    </section>

    <!-- Footer Banner -->
    <div class="site-banner">
      GREENWOOD NEWPORT MIDGET FOOTBALL ASSOCIATION
    </div>
  </main>

  <script src="/Buffalos/assets/site.js"></script>

  <script>
    // =========================
    // Sponsor Image Selection (Safe + Fallback)
    // Rules:
    // - 2 images from sponsormain01..20 (no duplicates)
    // - 1 image from sponsor01..20 (no duplicates)
    // - If only 1 sponsormain exists, use 2 of the normal sponsor images
    // - If any file doesn't exist, default to sponsormain01.png and sponsor01.png
    // =========================

    const BASE = "/Buffalos/assets/img/";
    const FALLBACK_MAIN = `${BASE}sponsormain01.png`;
    const FALLBACK = `${BASE}sponsor01.png`;

    function buildList(prefix, max){
      return Array.from({length:max}, (_,i) =>
        `${BASE}${prefix}${String(i+1).padStart(2,'0')}.png`
      );
    }

    function imageExists(src){
      return new Promise(resolve => {
        const img = new Image();
        img.onload = () => resolve(true);
        img.onerror = () => resolve(false);
        img.src = src;
      });
    }

    async function pickValid(source, used, fallback){
      const shuffled = source
        .filter(s => !used.has(s))
        .sort(() => 0.5 - Math.random());

      for(const src of shuffled){
        if(await imageExists(src)){
          used.add(src);
          return src;
        }
      }
      return fallback;
    }

    async function countExisting(list){
      let count = 0;
      for(const src of list){
        if(await imageExists(src)) count++;
      }
      return count;
    }

    async function loadSponsors(){
      const mainList = buildList("sponsormain", 20);
      const regList  = buildList("sponsor", 20);
      const used = new Set();
      const picks = [];

      const mainCount = await countExisting(mainList);

      if(mainCount >= 2){
        picks.push(await pickValid(mainList, used, FALLBACK_MAIN));
        picks.push(await pickValid(mainList, used, FALLBACK_MAIN));
        picks.push(await pickValid(regList, used, FALLBACK));
      } else if(mainCount === 1){
        picks.push(await pickValid(mainList, used, FALLBACK_MAIN));
        picks.push(await pickValid(regList, used, FALLBACK));
        picks.push(await pickValid(regList, used, FALLBACK));
      } else {
        picks.push(FALLBACK_MAIN);
        used.add(FALLBACK_MAIN);
        picks.push(await pickValid(regList, used, FALLBACK));
        picks.push(await pickValid(regList, used, FALLBACK));
      }

      const ids = ["sponsor1","sponsor2","sponsor3"];
      ids.forEach((id, i) => {
        const el = document.getElementById(id);
        if(!el) return;

        el.src = picks[i] || (i < 2 ? FALLBACK_MAIN : FALLBACK);

        // Hard fallback if a picked image is missing at runtime
        el.onerror = () => {
          el.onerror = null;
          el.src = (i < 2) ? FALLBACK_MAIN : FALLBACK;
        };
      });
    }

    loadSponsors();
  </script>
</body>
</html>
